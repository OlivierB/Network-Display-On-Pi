function AjaxManager(t){this.alertContainer=$("#"+t)}function WebSocketManager(t){this.alertContainer=$("#"+t)}function DataDispatcher(t){this.websocketManagers=[],this.connections=[],this.serverAddress=t}function TextFormatter(){}function resize(){$(".slide-div").height(window.innerHeight-100),$("#screen-container").slidesjs.width=window.innerHeight,$(".height-half").height((window.innerHeight-100)/2),$(".height-full").height(window.innerHeight-100)}function BandwidthChart(t,e,i){if(this.id=t,this.dataLength=i,this.local_network=[],this.incoming=[],this.outcoming=[],this.global=[],e)for(var a=new Date,s=a.getTime()-1e3*this.dataLength,n=this.dataLength;n--;)a.setTime(s),this.updateChart(0,0,0,0,a),s+=1e3;this.chart=new CanvasJS.Chart(this.id,{title:{text:"Traffic",fontFamily:"ChampWoff",fontSize:30},toolTip:{shared:!0,content:"<span style='\"'color: {color};'\"'><strong>{name}</strong></span> {y} kB/s"},data:[{type:"splineArea",name:"Global",color:"rgba(100,128,210, 0.2)",showInLegend:!1,dataPoints:this.global},{type:"spline",name:"Local Network",dataPoints:this.local_network,showInLegend:!0,markerSize:0},{type:"spline",name:"Incoming",showInLegend:!0,dataPoints:this.incoming,markerSize:0},{type:"spline",name:"Outcoming",showInLegend:!0,dataPoints:this.outcoming,markerSize:0}],axisY:{title:"kB/s",titleFontFamily:"ChampWoff",titleFontWeight:"bold"}}),this.chart.render()}function BandwidthChartAjax(t){BandwidthChart.call(this,t,!1,-1),AjaxManager.call(this,t+"-alert")}function BandwidthText(t,e){this.id=t,this.container=$("#"+this.id),this.font_size=e}function BandwidthTextAjax(t,e){BandwidthText.call(this,t,e),AjaxManager.call(this,t+"-alert")}function StackedColumnChart(t,e){this.id=t,this.data=[],this.chart=new CanvasJS.Chart(this.id,{title:{text:e},axisY:{title:"Number of packets"},data:this.data}),this.chart.render()}function StackedColumnChartAjax(t,e){AjaxManager.call(this,t+"-alert"),StackedColumnChart.call(this,t,e)}function DnsDisplayer(t){WebSocketManager.call(this,t+"-alert"),this.elems=[],this.busy=!1}function DnsDisplayerText(t,e,i){DnsDisplayer.call(this,t),this.container=$("#"+t),this.nbElemDisplayed=0,this.number_item_dns_list=e,this.container.css("font-size",i)}function BubbleDns(t,e,i,a,s,n,o,r){this.context=t,this.canvas_width=e,this.canvas_height=i,this.text=a,this.limitY=s,this.image=n,this.font_size=o,this.draw_bubble=r,this.moveX=0,this.context.font="bold "+this.font_size+"pt ChampWoff",this.context.textAlign="center",this.size=this.context.measureText(this.text).width+20,this.semi_size=this.size/2,this.x=Math.random()*(this.canvas_width-this.size)+this.semi_size,this.y=this.canvas_height+this.semi_size}function DnsDisplayerCanvas(t,e,i){DnsDisplayer.call(this,t),this.bubbles=[],this.id=t,this.font_size=e,this.draw_bubble=i,this.canvas=document.createElement("canvas"),this.resize(),document.getElementById(t).appendChild(this.canvas),$(window).resize(this.resize.bind(this)),this.context=this.canvas.getContext("2d"),this.images=[];var a=new Image;a.src="/res/img/redBubble.png",this.images[0]=a,a=new Image,a.src="/res/img/blueBubble.png",this.images[1]=a,a=new Image,a.src="/res/img/greenBubble.png",this.images[2]=a,a=new Image,a.src="/res/img/bubble.png",this.images[3]=a,a.onload=function(){this.busy=!1}.bind(this),this.bubbleSize=150,this.needRedraw=!1,this.animate()}function IpLocationMap(t){WebSocketManager.call(this,t+"-alert"),this.ips=[]}function IpLocationMapOffline(t,e,i){this.id=t,this.dither=e,this.opacity=i,IpLocationMap.call(this,t),this.canvas=document.createElement("canvas"),document.getElementById(t).appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this.resize();var a=new Image;a.src="/res/img/earth_bw.png",a.onload=function(){var t=this.canvas.width/this.canvas.height,e=a.width/a.height;e>t?(this.mapWidth=this.canvas.width,this.mapHeight=this.canvas.width/e,this.paddingHeight=(this.canvas.height-this.mapHeight)/2,this.paddingWidth=0):(this.mapHeight=this.canvas.height,this.mapWidth=this.canvas.height*e,this.paddingHeight=0,this.paddingWidth=(this.canvas.width-this.mapWidth)/2),this.context.drawImage(a,this.paddingWidth,this.paddingHeight,this.mapWidth,this.mapHeight)}.bind(this)}function IpLocationMapOnline(t,e,i){this.dither=e,this.opacity=i,IpLocationMap.call(this,t),this.map=L.map(t).setView([45.597889,-11.304932],2),L.tileLayer("http://{s}.tile.cloudmade.com/6b0ce74e6f434a7eb264a178d75f0458/997/256/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',maxZoom:18}).addTo(this.map)}function Ray(t,e,i,a){this.satellite_target=e,this.satellite_src=t;var s=new THREE.Geometry;s.vertices.push(t.getPosition()),s.vertices.push(e.getPosition()),s.dynamic=!0;var n=new THREE.LineBasicMaterial({color:i,linewidth:1});THREE.Line.call(this,s,n),this.time=a,this.clock=new THREE.Clock(!0),this.packet=new THREE.Mesh(new THREE.CubeGeometry(3,3,3,!1),new THREE.MeshLambertMaterial({color:16360206,doubleSided:!1,wireframe:!1,overdraw:!0})),this.add(this.packet)}function Scene3D(t,e){WebSocketManager.call(this,t+"-alert"),this.id=t,this.detail3D=e||5,this.satellites=[],this.rays=[],this.initCamera(),this.initController(),this.scene=new THREE.Scene,this.initLight(),this.initMaterial(),this.initGeometry(),this.sphere=new Satellite3D(this.sphereGeometry,"output",0,this.OutputMaterial),this.sphere.scale.set(3,3,3),this.scene.add(this.sphere),this.satellites[-1]=this.sphere,this.initRender(),this.onWindowResize(),this.needDisplay=!1,this.infoDisplay=new InformationsDisplay(t)}function Satellite3D(t,e,i,a,s,n){THREE.Object3D.call(this),this.rotation.z=2*Math.random()*Math.PI,this.rotation.y=2*Math.random()*Math.PI,this.rotation.x=2*Math.random()*Math.PI;var o=Math.random()/3,r=Math.random()*(1-o)/2,h=1-o-r;this.dir=[(o-.33)/50,(r-.33)/50,(h-.33)/50],a=a||this.createMaterialFromIp(e,s,n),this.cube=new THREE.Mesh(t,a),this.cube.position.set(i,0,0),this.add(this.cube)}function InformationsDisplay(t){this.loadConf(),this.infos=[],this.id_container=t}function PercentCounterChart(t,e,i){this.speed=100|i,this.id=t,this.id_data=e,this.chart=$("#"+t),this.chart.easyPieChart({animate:this.speed}),this.container=$("#"+this.id+" span")}function ServerStat(t){WebSocketManager.call(this,t+"-alert"),this.charts=[]}function SummaryCanvas(t){this.id=t,AjaxManager.call(this,t+"-alert"),this.canvas=document.createElement("canvas"),this.resize(),document.getElementById(t).appendChild(this.canvas),$(window).resize(this.resize.bind(this)),this.context=this.canvas.getContext("2d"),this.minHeight=-1}function BandwidthChartWebsocket(t){WebSocketManager.call(this,t+"-alert"),BandwidthChart.call(this,t,!0,100)}function BandwidthTextWebsocket(t,e){BandwidthText.call(this,t,e),WebSocketManager.call(this,t+"-alert")}function BarChart(t,e){this.id=t,this.data=[],this.chart=new CanvasJS.Chart(this.id,{title:{text:e,fontFamily:"ChampWoff",fontSize:30},axisX:{interval:1,gridThickness:0,labelFontSize:10,labelFontWeight:"normal",labelFontFamily:"Lucida Sans Unicode",labelFontColor:"black"},data:[{type:"column",name:"protocol",dataPoints:this.data}]}),this.chart.render()}function BarChartWebsocket(t,e,i){WebSocketManager.call(this,t+"-alert"),BarChart.call(this,t,i),this.id=t,this.id_data=e,this.container=$("#"+this.id)}$(function(){$("#slides").slidesjs({width:window.innerWidth,height:window.innerHeight-20,start:1,play:{active:!0,effect:"slide",interval:5e3,auto:!1,swap:!1,pauseOnHover:!1,restartDelay:2500},navigation:!1}),$(window).keyup(function(t){var e=t.which|t.keyCode;37===e?$(".slidesjs-previous").click():39===e?$(".slidesjs-next").click():38===e&&resize()})}),AjaxManager.prototype.connect=function(t,e,i){this.address=t,this.path=e,this.time=i,this.load()},AjaxManager.prototype.load=function(){$.ajax({type:"GET",url:"http://"+this.address+this.path,async:!0,success:function(t){t=$.parseJSON(t),this.dataManager(t),setTimeout(this.load.bind(this),this.time)}.bind(this),error:function(){var t='<span class="alert">Cannot reach the page.</span>';this.alertContainer.html(t)}.bind(this)})},WebSocketManager.prototype.connect=function(t,e){t.register(this,e)},WebSocketManager.prototype.onopen=function(){this.alertContainer.html("")},WebSocketManager.prototype.onerror=function(t){console.log("WebSocket Error "+t),this.protocolNotSupported=!0},WebSocketManager.prototype.onmessage=function(t){this.dataManager(t)},WebSocketManager.prototype.onclose=function(){this.protocolNotSupported?this.alertContainer.html('<span class="alert">Disconnected from server. Protocol not supported.</span>'):this.alertContainer.html('<span class="alert">Disconnected from server. Next try in 5 seconds.</span>')},DataDispatcher.prototype.register=function(t,e){e in this.websocketManagers||(this.websocketManagers[e]=[],this.connectToProt(this.serverAddress,e)),this.websocketManagers[e].push(t)},DataDispatcher.prototype.connectToProt=function(t,e){var i=new WebSocket(t,e);i.onopen=function(){console.log("Main connexion");for(var t=0,a=this.websocketManagers[e].length;a>t;t++)this.websocketManagers[e][t].onopen();this.connections.push(i)}.bind(this),i.onerror=function(t){console.log("WebSocket Error "+t);for(var i=0,a=this.websocketManagers[e].length;a>i;i++)this.websocketManagers[e][i].onerror(t);this.protocolNotSupported=!0}.bind(this),i.onmessage=function(t){for(var i=JSON.parse(t.data),a=0,s=this.websocketManagers[e].length;s>a;a++)this.websocketManagers[e][a].onmessage(i)}.bind(this),i.onclose=function(i){for(var a=0,s=this.websocketManagers[e].length;s>a;a++)this.websocketManagers[e][a].onclose(i);this.protocolNotSupported?console.log("protocolNotSupported"):setTimeout(function(){this.connectToProt(t,e)}.bind(this),5e3)}.bind(this)},dispatcher=new DataDispatcher(App.NDOPAddress),TextFormatter.formatNumber=function(t){var e="kB";return t>1e4&&(t/=1024,e="MB",t>1e4&&(t/=1024,e="GB",t>1e4&&(t/=1024,e="TB"))),$.number(t)+" "+e},$(window).resize(function(){resize()}),$(function(){resize()}),BandwidthChart.prototype.updateChart=function(t,e,i,a,s){this.xVal=s?new Date(s):new Date;var n=t;this.local_network.push({x:this.xVal,y:n});var o=e;this.incoming.push({x:this.xVal,y:o});var r=i;this.outcoming.push({x:this.xVal,y:r});var h=a;this.global.push({x:this.xVal,y:h}),this.xVal++,this.outcoming.length>this.dataLength&&this.dataLength>0&&(this.local_network.shift(),this.incoming.shift(),this.outcoming.shift(),this.global.shift())},BandwidthChart.prototype.clean=function(){this.local_network.length=0,this.incoming.length=0,this.outcoming.length=0,this.global.length=0},BandwidthChart.prototype.refresh=function(){this.chart.render()},BandwidthChartAjax.prototype=Object.create(BandwidthChart.prototype),BandwidthChartAjax.prototype.connect=AjaxManager.prototype.connect,BandwidthChartAjax.prototype.load=AjaxManager.prototype.load,BandwidthChartAjax.prototype.dataManager=function(t){for(var e=0,i=t.length;i>e;e++){var a=t[e];this.updateChart(parseInt(a.local),parseInt(a.incoming),parseInt(a.outcoming),parseInt(a.global),a.date)}this.refresh(),this.clean()},BandwidthText.prototype.dataManager=function(t){var e;e=t.list?t.list:t;var i='<table style="font-size:'+this.font_size+"px;line-height:"+this.font_size+'px;"><thead><tr><th colspan="2">Total traffic</th></tr></thead>';i+='<tr><td>Global</td>  <td><span class="bandwidth-number">'+TextFormatter.formatNumber(e.Ko)+" </span></td></tr>",i+='<tr><td>Local</td>  <td><span class="bandwidth-number">'+TextFormatter.formatNumber(e.loc_Ko)+"  </span></td></tr>",i+='<tr><td>Incoming</td> <td><span class="bandwidth-number">'+TextFormatter.formatNumber(e.in_Ko)+"  </span></td></tr>",i+='<tr><td>Outcoming</td>  <td><span class="bandwidth-number">'+TextFormatter.formatNumber(e.out_Ko)+"  </span></td></tr>",this.container.html(i)},BandwidthTextAjax.prototype=Object.create(AjaxManager.prototype),BandwidthTextAjax.prototype.dataManager=BandwidthText.prototype.dataManager,BaseAlert=function(t){this.id=t,this.alertContainer=$("#"+this.id+"-alert"),this.container=$("#"+this.id)},BaseAlert.prototype.load=function(){$.ajax({type:"GET",url:"http://"+this.address+this.url,async:!0,success:function(t){this.container.html(t),this.alertContainer.html("")}.bind(this),error:function(){var t='<span class="alert">Cannot reach the BASE page (Snort web page).</span>';this.alertContainer.html(t)}.bind(this)}),setTimeout(this.load.bind(this),this.timeout)},BaseAlert.prototype.connect=function(t,e,i){this.url=e,this.address=t,this.timeout=i,this.load()},StackedColumnChart.prototype.updateChart=function(t){this.data.length=0;for(var e=t.listProt,a=0;a<e.length;a++){var s=e[a];dataProt=[];var n=t.listValue.length;for(i=0;n>i;i++)dataProt.push({y:parseInt(t.listValue[i].value[s])||0,label:t.listValue[i].date});this.data.push({type:"stackedColumn100",name:s,showInLegend:"true",dataPoints:dataProt})}this.chart.render()},StackedColumnChartAjax.prototype=Object.create(AjaxManager.prototype),StackedColumnChartAjax.prototype.updateChart=StackedColumnChart.prototype.updateChart,StackedColumnChartAjax.prototype.dataManager=function(t){this.updateChart(t)},DnsDisplayer.prototype=Object.create(WebSocketManager.prototype),DnsDisplayer.prototype.dataManager=function(t){for(var e=t.list_dns_name.length;e--;)this.elems.length>0&&t.list_dns_name[e]==this.elems[this.elems.length-1].dnsName?this.elems[this.elems.length-1]={dnsName:this.elems[this.elems.length-1].dnsName,nb:this.elems[this.elems.length-1].nb+1}:this.elems.push({dnsName:t.list_dns_name[e],nb:1}),this.busy||this.addItem()},DnsDisplayerText.prototype=Object.create(DnsDisplayer.prototype),DnsDisplayerText.prototype.addItem=function(){this.elems.length>0?(this.busy=!0,str="<tr><td>"+this.elems[0].dnsName+"</td><td>"+this.elems[0].nb+"</td></tr>",$("#dns-table > tbody:first").prepend(str),this.elems.shift(),this.nbElemDisplayed<this.number_item_dns_list?this.nbElemDisplayed++:$("#dns-table tr:last").detach(),setTimeout(this.addItem.bind(this),1e3)):this.busy=!1},BubbleDns.prototype.display=function(){this.context.fillText(this.text,this.x+0,this.y+0),this.draw_bubble&&this.context.drawImage(this.image,this.x-this.semi_size,this.y-this.semi_size,this.size,this.size)},BubbleDns.prototype.update=function(){return this.y-=2,this.moveX+=(Math.random()-.5)/10,this.x+=this.moveX,this.limitY<this.y+this.size},DnsDisplayerCanvas.prototype=Object.create(DnsDisplayer.prototype),DnsDisplayerCanvas.prototype.addItem=function(){this.elems.length>0?(this.busy=!0,this.needRedraw||this.addBubble(this.elems[0].dnsName),this.needRedraw=!0,this.elems.shift(),setTimeout(this.addItem.bind(this),1e3)):this.busy=!1},DnsDisplayerCanvas.prototype.addBubble=function(t){var e=Math.floor(Math.random()*this.images.length),i=new BubbleDns(this.context,this.canvas.width,this.canvas.height,t,0,this.images[e],this.font_size,this.draw_bubble);this.bubbles.push(i)},DnsDisplayerCanvas.prototype.animate=function(){requestAnimationFrame(this.animate.bind(this)),this.render()},DnsDisplayerCanvas.prototype.render=function(){this.needRedraw=!1,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=this.bubbles.length;t--;)this.bubbles[t].update()?this.bubbles[t].display():(delete this.bubbles[t],this.bubbles.splice(t,1))},DnsDisplayerCanvas.prototype.resize=function(){this.canvas.width=$("#"+this.id).width(),this.canvas.height=$("#"+this.id).height()},IpLocationMap.prototype=Object.create(WebSocketManager.prototype),IpLocationMap.prototype.addPointFromIP=function(t,e){$.ajax({type:"GET",url:"http://"+App.freeGeoIpAdress+"/json/"+t,async:!0,success:function(t){this.addPoint(t.latitude,t.longitude,e)}.bind(this)})},IpLocationMap.prototype.dataManager=function(t){if(null!==t.iplist)for(var e=t.iplist.length;e--;){var i=t.iplist[e];i in this.ips||(this.addPointFromIP(i),this.ips[i]=1)}},IpLocationMapOffline.prototype=Object.create(IpLocationMap.prototype),IpLocationMapOffline.prototype.addPoint=function(t,e,i){i=i||"red";var a=this.mapWidth*(180+e)/360+this.paddingWidth,s=this.mapHeight*(90-t)/180+this.paddingHeight;a+=(Math.random()-.5)*this.dither,s+=(Math.random()-.5)*this.dither,this.drawCircle(a,s,3,i)},IpLocationMapOffline.prototype.drawCircle=function(t,e,i,a){this.context.globalAlpha=this.opacity,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI,!1),this.context.fillStyle=a,this.context.fill()},IpLocationMapOffline.prototype.resize=function(){this.canvas.width=$("#"+this.id).width(),this.canvas.height=$("#"+this.id).height()},IpLocationMapOnline.prototype=Object.create(IpLocationMap.prototype),IpLocationMapOnline.prototype.addPoint=function(t,e,i){i=i||"red",t+=(Math.random()-.5)*this.dither,e+=(Math.random()-.5)*this.dither,L.circle([t,e],100,{color:i,fillColor:i,fillOpacity:this.opacity}).addTo(this.map)},Ray.prototype=Object.create(THREE.Line.prototype),Ray.prototype.update=function(){return this.clock.getElapsedTime()<this.time?(this.geometry.vertices[0]=this.satellite_src.getPosition(),this.geometry.vertices[1]=this.satellite_target.getPosition(),this.geometry.verticesNeedUpdate=!0,this.packet.position=this.geometry.vertices[1].sub(this.geometry.vertices[0]).multiplyScalar(this.clock.getElapsedTime()/this.time).add(this.geometry.vertices[0]),!0):!1},Scene3D.prototype=Object.create(WebSocketManager.prototype),Scene3D.prototype.dataManager=function(t){if("communications"in t)for(var e=0;e<t.communications.length;e++)t.communications[e].ip_src in this.satellites||this.addSatellite(t.communications[e].ip_src),t.communications[e].ip_dst in this.satellites||this.addSatellite(t.communications[e].ip_dst),this.addRay(this.satellites[t.communications[e].ip_src],this.satellites[t.communications[e].ip_dst],16777215*Math.random(),this.fromSizeToTime(t.communications[e].number));this.needDisplay=!0},Scene3D.prototype.fromSizeToTime=function(t){return Math.log(.8*t)+1},Scene3D.prototype.initCamera=function(){this.camera=new THREE.PerspectiveCamera(80,this.SCREEN_WIDTH/this.SCREEN_HEIGHT,1,3e3),this.camera.position.z=200,this.camera.position.x=200,this.camera.position.y=200},Scene3D.prototype.initController=function(){this.controls=new THREE.OrbitControls(this.camera),this.controls.addEventListener("change",this.render.bind(this))},Scene3D.prototype.initLight=function(){var t=new THREE.PointLight(16777215);t.position.set(0,0,0),this.scene.add(t);var e=new THREE.SpotLight(16777215);e.position.set(100,200,100),e.castShadow=!0,e.shadowMapWidth=1024,e.shadowMapHeight=1024,e.shadowCameraNear=500,e.shadowCameraFar=4e3,e.shadowCameraFov=30,this.scene.add(e);var i=new THREE.AmbientLight(10066329);this.scene.add(i)},Scene3D.prototype.initMaterial=function(){this.YellowMaterial=new THREE.MeshLambertMaterial({color:16360206,doubleSided:!1,wireframe:!1,overdraw:!0}),this.OutputMaterial=this.detail3D>5?new THREE.MeshLambertMaterial({map:new THREE.ImageUtils.loadTexture("/res/img/Earth-Clouds.jpg")}):new THREE.MeshLambertMaterial({color:203,doubleSided:!1,wireframe:!1,overdraw:!0}),truc=this.scene},Scene3D.prototype.initGeometry=function(){var t=10*this.detail3D-50,e=10*this.detail3D-50;this.sphereGeometry=new THREE.SphereGeometry(10,t,e,!1),this.cubeGeometry=new THREE.CubeGeometry(15,15,15,!1)},Scene3D.prototype.initAxisHelper=function(){var t=THREE.AxisHelper(100);this.scene.add(t)},Scene3D.prototype.addSatellite=function(t){var e,i,a=this.infoDisplay.addIp(t);a&&(e=a.textureColor,i=a.fontColor);var s;s=this.detail3D>5?new Satellite3D(this.sphereGeometry,t>>>24,150*Math.random()+100,null,e,i):new Satellite3D(this.cubeGeometry,t>>>24,150*Math.random()+100,null,e,i),this.scene.add(s),this.satellites[t]=s},Scene3D.prototype.removeSatellite=function(t){t in this.satellites&&(this.scene.remove(this.satellites[t]),delete this.satellites[t])},Scene3D.prototype.addRay=function(t,e,i,a){if(!this.needDisplay){var s=new Ray(t,e,i,a);this.scene.add(s),this.rays.push(s),this.numberSatellitesAddedSinceRefresh++}},Scene3D.prototype.initRender=function(){this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(this.SCREEN_WIDTH,this.SCREEN_HEIGHT),document.getElementById(this.id).appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize.bind(this),!1)},Scene3D.prototype.onWindowResize=function(){this.SCREEN_WIDTH=$("#"+this.id).width(),this.SCREEN_HEIGHT=window.innerHeight,this.windowHalfX=this.SCREEN_WIDTH/2,this.windowHalfY=this.SCREEN_HEIGHT/2,this.camera.aspect=this.SCREEN_WIDTH/this.SCREEN_HEIGHT,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.SCREEN_WIDTH,this.SCREEN_HEIGHT)},Scene3D.prototype.animate=function(){this.controls.update(),requestAnimationFrame(this.animate.bind(this)),this.render()},Scene3D.prototype.render=function(){this.needDisplay=!1;for(var t in this.satellites)this.satellites[t].update();for(var e=this.rays.length;e--;){var i=this.rays[e];i.update()||(this.scene.remove(i),this.rays.splice(e,1))}this.renderer.render(this.scene,this.camera)},Satellite3D.prototype=Object.create(THREE.Object3D.prototype),Satellite3D.prototype.rotate=function(t,e,i){this.rotation.z+=t,this.rotation.y+=e,this.rotation.x+=i},Satellite3D.prototype.getPosition=function(){return this.localToWorld(this.cube.position.clone())},Satellite3D.prototype.update=function(){this.rotate(this.dir[0],this.dir[1],this.dir[2])},Satellite3D.prototype.createMaterialFromIp=function(t,e,i){var a=document.createElement("canvas"),s=a.getContext("2d");s.canvas.width=300,s.canvas.height=300,s.fillStyle=e||"#F9A30E",s.fillRect(0,0,300,300),s.font="Bold 80px Arial",s.fillStyle=i||"rgba(255,0,0,0.95)",s.fillText(t,55,175);var n=new THREE.Texture(a);return n.needsUpdate=!0,new THREE.MeshLambertMaterial({map:n})},InformationsDisplay.prototype.loadConf=function(){for(var t=0;t<Network3DMaskList.length;t++){var e=Network3DMaskList[t].address.split(".");Network3DMaskList[t].addressHexa=0;for(var i=0;4>i;i++){var a=parseFloat(e[i]);Network3DMaskList[t].addressHexa+=a<<8*i}}},InformationsDisplay.prototype.addIp=function(t){for(var e=0,i=Network3DMaskList.length;i>e&&Network3DMaskList[e].addressHexa!=this.maskIp(t,Network3DMaskList[e].mask);)e++;return e!=i?(Network3DMaskList[e].address+"/"+Network3DMaskList[e].mask in this.infos?this.infos[Network3DMaskList[e].address+"/"+Network3DMaskList[e].mask].number++:this.infos[Network3DMaskList[e].address+"/"+Network3DMaskList[e].mask]={number:1,textureColor:Network3DMaskList[e].textureColor,fontColor:Network3DMaskList[e].fontColor},this.refreshDisplay(),{textureColor:Network3DMaskList[e].textureColor,fontColor:Network3DMaskList[e].fontColor}):void 0},InformationsDisplay.prototype.maskIp=function(t,e){var i=4294967295>>>32-e;return t&i},InformationsDisplay.prototype.refreshDisplay=function(){var t='<table class="table"><thead><tr><th>Network / IP</th><th>Number</th></tr></thead>';for(var e in this.infos)t+='<tr style="background-color:'+this.infos[e].textureColor+";color:"+this.infos[e].fontColor+'"><td>'+e+"</td><td>"+this.infos[e].number+"</td></tr>";t+="</table>";var i=$("#"+this.id_container+"-table-container");i.html(t)},PercentCounterChart.prototype.updateChart=function(t){this.chart.data("easyPieChart").update(t),this.container.text(t.toFixed(2)+"%")},ServerStat.prototype=Object.create(WebSocketManager.prototype),ServerStat.prototype.dataManager=function(t){for(var e=this.charts.length;e--;){var i=this.charts[e];i.id_data in t&&i.updateChart(t[i.id_data])}},ServerStat.prototype.add=function(t,e,i){this.charts.push(new PercentCounterChart(t,e,i))},SummaryCanvas.prototype=Object.create(AjaxManager.prototype),SummaryCanvas.prototype.dataManager=function(t){this.save=t,this.drawFromData(t)},SummaryCanvas.prototype.drawFromData=function(t){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var e=t.list;this.addBar(e.out_Ko,e.Ko,0,"rgb(69, 194, 197)"),this.addBar(e.in_Ko,e.Ko,1,"rgb(247, 141, 63)"),this.addBar(e.loc_Ko,e.Ko,2,"rgb(16, 46, 55)"),this.drawDate(t.date_begin),this.drawLegend()},SummaryCanvas.prototype.addBar=function(t,e,i,a){var s=t/e,n=1/6+.25*i,o=1/8+.5*(1-s),r=1/6,h=1*s/2+1/35;(-1==this.minHeight||this.minHeight>h)&&(this.minHeight=h),this.context.beginPath(),this.context.rect(this.ratioX(n),this.ratioY(o),this.ratioX(r),this.ratioY(h)),this.context.fillStyle=a,this.context.fill(),this.drawText(TextFormatter.formatNumber(t),this.ratioX(n+1/12),this.ratioY(o-1/35),a,this.ratioX(1/35),"")},SummaryCanvas.prototype.drawText=function(t,e,i,a,s,n){this.context.font=n+" "+s+"pt ChampWoff",this.context.fillStyle=a,this.context.textAlign="center",this.context.fillText(t,e,i)},SummaryCanvas.prototype.resize=function(){this.canvas.width=$("#"+this.id).width(),this.canvas.height=$("#"+this.id).height(),this.save&&(this.drawFromData(this.save),this.drawLegend())},SummaryCanvas.prototype.ratioX=function(t){return t*this.canvas.width},SummaryCanvas.prototype.ratioY=function(t){return t*this.canvas.height},SummaryCanvas.prototype.drawLegend=function(){var t=5/8+1/70,e="black",i="#9A9A9A";this.minHeight>-1&&this.minHeight<1/30*this.canvas.width/this.canvas.height+1/70&&(t+=1/30*this.canvas.width/this.canvas.height+1/70,i="black"),this.drawText("UP",this.ratioX(.25),this.ratioY(t),e,this.ratioX(1/30),"bold"),this.drawText("DOWN",this.ratioX(.5),this.ratioY(t),e,this.ratioX(1/30),"bold"),this.drawText("LOCAL",this.ratioX(.75),this.ratioY(t),i,this.ratioX(1/30),"bold")},SummaryCanvas.prototype.drawDate=function(t){var e=.75+1/30;this.drawText("Since "+t,this.ratioX(.25),this.ratioY(e),"black",this.ratioX(.025),"bold")},BandwidthChartWebsocket.prototype=Object.create(WebSocketManager.prototype),BandwidthChartWebsocket.prototype.dataManager=function(t){this.updateChart(t.loc_Ko,t.in_Ko,t.out_Ko,t.Ko),this.refresh()},BandwidthChartWebsocket.prototype.updateChart=BandwidthChart.prototype.updateChart,BandwidthChartWebsocket.prototype.refresh=BandwidthChart.prototype.refresh,BandwidthTextWebsocket.prototype=Object.create(WebSocketManager.prototype),BandwidthTextWebsocket.prototype.dataManager=BandwidthText.prototype.dataManager,BarChart.prototype.updateChart=function(t){this.data.length=0;for(var e=0;e<t.length;e++)this.data.push({y:t[e][1],label:t[e][0]});this.chart.render()},BarChartWebsocket.prototype=Object.create(WebSocketManager.prototype),BarChartWebsocket.prototype.updateChart=BarChart.prototype.updateChart,BarChartWebsocket.prototype.dataManager=function(t){this.updateChart(t[this.id_data])};